<!-- Content -->
<div class="w-full max-w-3xl">
    <!-- Form -->
    <form [formGroup]="usuarioForm">
        <!-- Section -->
        <div class="w-full">
            <div class="text-xl">Usuario</div>
            <div class="text-secondary" [ngSwitch]="mode">
                <ng-container *ngSwitchCase="'edit'"> Verificar que la información sea correcta. </ng-container>
                <ng-container *ngSwitchCase="'password'">
                    Cambiar contraseña de {{ selectedUsuario.nombreUsuario }}.
                </ng-container>
                <ng-container *ngSwitchCase="'new'"> Crear nuevo usuario Solucrea. </ng-container>
            </div>
        </div>
        <div class="grid sm:grid-cols-4 gap-6 w-full mt-8">
            <ng-container *ngIf="mode === 'edit' || mode === 'new'">
                <!-- Nombre -->
                <div class="sm:col-span-4">
                    <mat-form-field class="fuse-mat-no-subscript w-full">
                        <mat-label>Nombre</mat-label>
                        <mat-icon class="icon-size-5" [svgIcon]="'heroicons_solid:user'" matPrefix></mat-icon>
                        <input [formControlName]="'nombre'" matInput />
                    </mat-form-field>
                </div>
                <!-- Apellido -->
                <div class="sm:col-span-4">
                    <mat-form-field class="fuse-mat-no-subscript w-full">
                        <mat-label>Apellidos</mat-label>
                        <mat-icon class="icon-size-5" [svgIcon]="'heroicons_solid:user'" matPrefix></mat-icon>
                        <input [formControlName]="'apellido'" matInput />
                    </mat-form-field>
                </div>
                <!-- Nombre de Usuario -->
                <div class="sm:col-span-4">
                    <mat-form-field class="fuse-mat-no-subscript fuse-mat-emphasized-affix w-full max-w-1/2">
                        <mat-label>Nombre de Usuario</mat-label>
                        <div class="text-secondary" matPrefix>solucrea/</div>
                        <input [formControlName]="'nombreUsuario'" matInput />
                    </mat-form-field>
                    <!-- Role -->
                    <mat-form-field class="fuse-mat-no-subscript fuse-mat-emphasized-affix ml-4 w-1/3">
                        <mat-label>Rol</mat-label>
                        <mat-select
                            [panelClass]="'w-72 min-w-72 max-w-72 h-auto'"
                            [formControlName]="'role'"
                            disableOptionCentering
                            #roleSelect="matSelect"
                        >
                            <mat-select-trigger class="text-md">
                                <span class="ml-1 font-medium">{{ roleSelect.value | titlecase }}</span>
                            </mat-select-trigger>
                            <ng-container *ngFor="let role of roles">
                                <mat-option class="h-auto py-4 leading-none" [value]="role.value">
                                    <div class="font-medium">
                                        {{ role.label }}
                                    </div>
                                    <div class="mt-1.5 text-sm whitespace-normal leading-normal text-secondary">
                                        {{ role.description }}
                                    </div>
                                </mat-option>
                            </ng-container>
                        </mat-select>
                    </mat-form-field>
                </div>
                <!-- password -->
                <div class="sm:col-span-4" *ngIf="mode === 'new'">
                    <mat-form-field class="fuse-mat-no-subscript w-full">
                        <mat-label>Contraseña</mat-label>
                        <mat-icon class="icon-size-5" [svgIcon]="'heroicons_solid:key'" matPrefix></mat-icon>
                        <input [formControlName]="'password'" type="password" matInput />
                    </mat-form-field>
                    <div class="mt-1 text-md text-hint">
                        Minimo 8 caracteres. Debe incluir una letra mayúscula, una minúscula y un caracter especial
                        (#?!@$%^&*-).
                    </div>
                    <ng-container *ngIf="password.touched">
                        <mat-error *ngIf="password.errors?.minlength">
                            La nueva contraseña debe tener mínimo 8 caracteres.
                        </mat-error>
                        <mat-error *ngIf="password.errors?.passwordStrength">
                            la Contraseña debe incluir mínimo 8 caracteres. Al menos una mayúscula, una minúscula, un
                            número y un caracter especial (#?!@$%^&*-).
                        </mat-error>
                    </ng-container>
                </div>
            </ng-container>
            <ng-container *ngIf="mode === 'password'">
                <!-- password -->
                <div class="sm:col-span-4">
                    <mat-form-field class="fuse-mat-no-subscript w-full">
                        <mat-label>Nueva contraseña</mat-label>
                        <mat-icon class="icon-size-5" [svgIcon]="'heroicons_solid:key'" matPrefix></mat-icon>
                        <input [formControlName]="'password'" type="password" matInput />
                    </mat-form-field>
                    <div class="mt-1 text-md text-hint">
                        Minimo 8 caracteres. Debe incluir una letra mayúscula, una minúscula y un caracter especial
                        (#?!@$%^&*-).
                    </div>
                    <ng-container *ngIf="password.touched">
                        <mat-error *ngIf="password.errors?.minlength">
                            La nueva contraseña debe tener mínimo 8 caracteres.
                        </mat-error>
                        <mat-error *ngIf="password.errors?.passwordStrength">
                            la Contraseña debe incluir mínimo 8 caracteres. Al menos una mayúscula, una minúscula, un
                            número y un caracter especial (#?!@$%^&*-).
                        </mat-error>
                    </ng-container>
                </div>
            </ng-container>
        </div>

        <!-- Divider -->
        <div class="mt-11 mb-10 border-t"></div>

        <!-- Acciones -->
        <div class="flex items-center justify-end">
            <button mat-stroked-button type="button" (click)="cancelEdit()">Cancelar</button>
            <button
                class="ml-4"
                mat-flat-button
                type="button"
                [color]="'primary'"
                (click)="mode !== 'new' ? updateUsuario() : saveUsuario()"
                [disabled]="!usuarioForm.touched || (mode === 'password' && !password.value) || usuarioForm.invalid"
            >
                Guardar
            </button>
        </div>
    </form>
</div>
